### 개요

지도에서 특정 좌표를 클릭으로 선택하고, 선택된 좌표를 기준으로 500M 반경의 Circle을 표시하는 영역 제한 테스트 페이지입니다.

### 주요 기능

- **영역 중심점 선택**: 지도 클릭을 통해 원하는 위치의 좌표를 선택할 수 있습니다
- **동적 반경 영역 표시**: 선택된 좌표를 중심으로 반경을 조정할 수 있는 원형 영역을 표시합니다
- **반경 조정**: 슬라이더를 통해 100m~2000m 범위에서 반경을 실시간으로 조정할 수 있습니다
- **좌표 정보 표시**: 선택된 좌표의 위도/경도 정보를 소수점 6자리까지 표시합니다
- **선택 초기화**: 선택된 좌표와 Circle을 제거하는 기능

### 사용 방법

1. 지도에서 원하는 위치를 클릭합니다
2. 클릭한 위치에 빨간색 마커가 표시됩니다
3. 마커 주변으로 기본 500M 반경의 원형 영역이 표시됩니다
4. 슬라이더를 조작하여 100m~2000m 범위에서 반경을 실시간으로 조정할 수 있습니다
5. 상단에 선택된 좌표 정보(위도/경도)와 현재 반경이 표시됩니다
6. "선택 초기화" 버튼으로 선택을 해제할 수 있습니다

### 기술적 특징

#### Native Google Maps API Circle 사용

이 구현에서는 React Google Maps API의 `Circle` 컴포넌트 대신 **Native Google Maps API Circle**을 직접 사용합니다:

```javascript
// Circle 중복 생성 문제 해결을 위해 Native API 사용
const circle = new window.google.maps.Circle({
  strokeColor: "#FF0000",
  strokeOpacity: 0.8,
  strokeWeight: 2,
  fillColor: "#FF0000",
  fillOpacity: 0.15,
  map: map,
  center: coordinate,
  radius: radius,
});
```

#### Circle 중복 생성 문제 해결

- **문제**: React Google Maps API의 `Circle` 컴포넌트는 첫 클릭 시 Circle이 중복 생성되거나 이전 Circle이 완전히 제거되지 않는 문제 발생
- **해결**: 매 클릭마다 기존 Circle을 `setMap(null)`로 완전 제거 후 새로운 Circle 생성
- **디버깅**: 콘솔 로그(`🔵`)를 통해 Circle 생성/제거/업데이트 과정 추적 가능

#### 상태 관리

- `map`: GoogleMap 인스턴스 참조
- `currentCircle`: 현재 표시된 Circle 객체 참조
- `selectedCoordinate`: 선택된 좌표 정보
- `radius`: 현재 반경 값

### 사용 방법

1. 지도에서 원하는 위치를 클릭합니다
2. 클릭한 위치에 빨간색 마커가 표시됩니다
3. 마커 주변으로 기본 500M 반경의 원형 영역이 표시됩니다
4. 슬라이더를 조작하여 100m~2000m 범위에서 반경을 실시간으로 조정할 수 있습니다
5. 상단에 선택된 좌표 정보(위도/경도)와 현재 반경이 표시됩니다
6. "선택 초기화" 버튼으로 선택을 해제할 수 있습니다

### 주의사항

- **Circle 관리**: Native Google Maps API를 사용하므로 Circle 생성/제거를 수동으로 관리
- **메모리 누수 방지**: 컴포넌트 언마운트 시 Circle 정리 필요 (현재 구현에서는 clearSelection으로 처리)
- **반경 범위**: 최소 100m부터 최대 2000m까지 100m 단위로 설정 가능
- **좌표 정확도**: 클릭한 정확한 위치의 좌표가 소수점 6자리까지 표시
- **디버깅**: 브라우저 콘솔에서 🔵 로그를 통해 Circle 동작 과정 확인 가능

### 코드

```jsx
// src/pages/real/CoordinateSelectionTestPage.jsx
import { GoogleMap, Marker } from "@react-google-maps/api";
import "@/pages/map/MapPage.css";
import MarkdownComponent from "@/components/Markdown";
import React, { useState, useEffect } from "react";

const CoordinateSelectionTestPage = () => {
  const [markdown, setMarkdown] = useState("");
  const [selectedCoordinate, setSelectedCoordinate] = useState(null);
  const [radius, setRadius] = useState(500);
  const [mapCenter, setMapCenter] = useState({
    lat: 37.5665,
    lng: 126.978,
  });
  const [map, setMap] = useState(null);
  const [currentCircle, setCurrentCircle] = useState(null);

  const mapOptions = {
    gestureHandling: "greedy",
    zoomControl: true,
    scaleControl: false,
    mapTypeControl: false,
    streetViewControl: false,
    fullscreenControl: false,
    disableDefaultUI: false,
    scrollwheel: true,
    draggable: true,
    clickableIcons: false,
  };

  useEffect(() => {
    fetch(`/docs/실전기능/영역제한_테스트.md`)
      .then((response) => response.text())
      .then((text) => setMarkdown(text))
      .catch(() =>
        setMarkdown("# 영역 제한 테스트\n\n문서를 로드할 수 없습니다."),
      );
  }, []);

  const handleMapClick = (event) => {
    const coordinate = {
      lat: event.latLng.lat(),
      lng: event.latLng.lng(),
    };
    console.log("🔵 Map clicked:", coordinate);

    // 기존 circle 제거
    if (currentCircle) {
      console.log("🔵 Removing existing circle");
      currentCircle.setMap(null);
    }

    setSelectedCoordinate(coordinate);

    // 새로운 circle 생성 (Native Google Maps API 사용)
    if (map) {
      console.log("🔵 Creating new circle");
      const circle = new window.google.maps.Circle({
        strokeColor: "#FF0000",
        strokeOpacity: 0.8,
        strokeWeight: 2,
        fillColor: "#FF0000",
        fillOpacity: 0.15,
        map: map,
        center: coordinate,
        radius: radius,
      });
      setCurrentCircle(circle);
    }
  };

  const clearSelection = () => {
    if (currentCircle) {
      console.log("🔵 Clearing circle");
      currentCircle.setMap(null);
      setCurrentCircle(null);
    }
    setSelectedCoordinate(null);
  };

  const formatCoordinate = (coord) => {
    if (!coord) return "선택된 좌표가 없습니다";
    return `위도: ${coord.lat.toFixed(6)}, 경도: ${coord.lng.toFixed(6)}`;
  };

  const handleRadiusChange = (event) => {
    const newRadius = parseInt(event.target.value);
    setRadius(newRadius);

    // 기존 circle 반경 업데이트
    if (currentCircle) {
      console.log("🔵 Updating circle radius:", newRadius);
      currentCircle.setRadius(newRadius);
    }
  };

  return (
    <div className="map-page">
      <div className="map-container">
        <div
          className="controls"
          style={{
            padding: "10px",
            backgroundColor: "#f5f5f5",
            marginBottom: "10px",
          }}
        >
          <div style={{ marginBottom: "10px", fontSize: "14px" }}>
            <strong>선택된 좌표:</strong> {formatCoordinate(selectedCoordinate)}
          </div>

          <div style={{ marginBottom: "15px" }}>
            <label
              style={{
                display: "block",
                marginBottom: "5px",
                fontSize: "14px",
                fontWeight: "bold",
              }}
            >
              반경: {radius}m
            </label>
            <input
              type="range"
              min="100"
              max="2000"
              step="100"
              value={radius}
              onChange={handleRadiusChange}
              style={{
                width: "100%",
                height: "6px",
                borderRadius: "3px",
                background: "#ddd",
                outline: "none",
                marginRight: "10px",
              }}
            />
            <div
              style={{
                display: "flex",
                justifyContent: "space-between",
                fontSize: "12px",
                color: "#666",
                marginTop: "2px",
              }}
            >
              <span>100m</span>
              <span>2000m</span>
            </div>
          </div>

          <button
            onClick={clearSelection}
            disabled={!selectedCoordinate}
            style={{
              padding: "8px 16px",
              backgroundColor: "#2196F3",
              color: "white",
              border: "none",
              borderRadius: "4px",
              cursor: selectedCoordinate ? "pointer" : "not-allowed",
              opacity: selectedCoordinate ? 1 : 0.5,
            }}
          >
            선택 초기화
          </button>
          <div style={{ marginTop: "10px", fontSize: "12px", color: "#666" }}>
            지도를 클릭하여 좌표를 선택하고, 슬라이더로 반경을 조정하세요.
          </div>
        </div>

        <GoogleMap
          mapContainerClassName="map-inner"
          center={mapCenter}
          zoom={15}
          options={mapOptions}
          onClick={handleMapClick}
          onLoad={setMap}
        >
          {selectedCoordinate && (
            <Marker
              position={selectedCoordinate}
              title={`선택된 좌표: ${formatCoordinate(selectedCoordinate)}`}
              icon={{
                url: "data:image/svg+xml;charset=UTF-8,%3csvg width='24' height='24' xmlns='http://www.w3.org/2000/svg'%3e%3ccircle cx='12' cy='12' r='10' fill='%23FF0000' stroke='%23FFFFFF' stroke-width='2'/%3e%3c/svg%3e",
                scaledSize: new window.google.maps.Size(24, 24),
                anchor: new window.google.maps.Point(12, 12),
              }}
            />
          )}
        </GoogleMap>
      </div>

      <div className="markdown-section">
        <MarkdownComponent content={markdown} />
      </div>
    </div>
  );
};

export default CoordinateSelectionTestPage;
```
